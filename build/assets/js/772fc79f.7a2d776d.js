"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[4758],{7834:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"module-1-ros2/nodes-topics-services","title":"Nodes, Topics, and Services","description":"Nodes as building blocks, Pub/Sub pattern with Topics, Messages (std_msgs, geometry_msgs), Request/Response with Services, Actions for long-running tasks, QoS settings.","source":"@site/docs/module-1-ros2/nodes-topics-services.mdx","sourceDirName":"module-1-ros2","slug":"/module-1-ros2/nodes-topics-services","permalink":"/Physical-AI-Humanoid-Robotics-Textbook/docs/module-1-ros2/nodes-topics-services","draft":false,"unlisted":false,"editUrl":"https://github.com/Darakhshan08/Physical-AI-Humanoid-Robotics-Textbook/tree/main/docs/module-1-ros2/nodes-topics-services.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"nodes-topics-services","title":"Nodes, Topics, and Services","sidebar_label":"Nodes, Topics, Services","sidebar_position":2,"description":"Nodes as building blocks, Pub/Sub pattern with Topics, Messages (std_msgs, geometry_msgs), Request/Response with Services, Actions for long-running tasks, QoS settings.","keywords":["ros2","nodes","topics","services","actions","qos","pubsub"]},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Architecture","permalink":"/Physical-AI-Humanoid-Robotics-Textbook/docs/module-1-ros2/architecture"},"next":{"title":"Python Packages","permalink":"/Physical-AI-Humanoid-Robotics-Textbook/docs/module-1-ros2/python-packages"}}');var i=n(4848),o=n(8453);const t={id:"nodes-topics-services",title:"Nodes, Topics, and Services",sidebar_label:"Nodes, Topics, Services",sidebar_position:2,description:"Nodes as building blocks, Pub/Sub pattern with Topics, Messages (std_msgs, geometry_msgs), Request/Response with Services, Actions for long-running tasks, QoS settings.",keywords:["ros2","nodes","topics","services","actions","qos","pubsub"]},l="Nodes, Topics, and Services",c={},a=[{value:"Nodes: Building Blocks of ROS 2",id:"nodes-building-blocks-of-ros-2",level:2},{value:"Topics: Pub/Sub Pattern",id:"topics-pubsub-pattern",level:2},{value:"Messages: std_msgs, geometry_msgs",id:"messages-std_msgs-geometry_msgs",level:3},{value:"Example: Simple Publisher and Subscriber",id:"example-simple-publisher-and-subscriber",level:3},{value:"Services: Request/Response",id:"services-requestresponse",level:2},{value:"Example: Simple Service Server and Client",id:"example-simple-service-server-and-client",level:3},{value:"Actions: Long-running tasks",id:"actions-long-running-tasks",level:2},{value:"QoS Settings",id:"qos-settings",level:2}];function d(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"nodes-topics-and-services",children:"Nodes, Topics, and Services"})}),"\n",(0,i.jsx)(s.p,{children:"Nodes, topics, and services form the fundamental communication mechanisms in ROS 2. Understanding how these elements interact is crucial for building distributed robotic applications."}),"\n",(0,i.jsx)(s.h2,{id:"nodes-building-blocks-of-ros-2",children:"Nodes: Building Blocks of ROS 2"}),"\n",(0,i.jsxs)(s.p,{children:["A ",(0,i.jsx)(s.strong,{children:"node"})," is an executable that performs computation. In ROS 2, nodes are typically isolated processes designed to do one thing well. This modularity allows for:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Fault isolation"}),": If one node crashes, others can continue to operate."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Reusability"}),": Nodes can be reused in different applications or across different robots."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Distribution"}),": Nodes can run on different machines or even different operating systems, communicating seamlessly."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Each node has a unique name within the ROS graph, allowing other nodes to identify and interact with it."}),"\n",(0,i.jsx)(s.h2,{id:"topics-pubsub-pattern",children:"Topics: Pub/Sub Pattern"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Topics"})," are a named bus over which nodes exchange messages using a publish-subscribe (pub/sub) pattern."]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Publishers"}),": Nodes that send messages to a topic."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Subscribers"}),": Nodes that receive messages from a topic."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"This decoupled communication mechanism means publishers and subscribers don't need to know about each other's existence. They only need to agree on the topic name and message type."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-mermaid",children:"graph LR\r\n    P1[Publisher Node 1] -- publishes /sensor_data --\x3e T1(Topic: /sensor_data)\r\n    P2[Publisher Node 2] -- publishes /motor_commands --\x3e T2(Topic: /motor_commands)\r\n\r\n    T1 --\x3e S1[Subscriber Node 1]\r\n    T2 --\x3e S2[Subscriber Node 2]\r\n    T1 --\x3e S3[Subscriber Node 3]\n"})}),"\n",(0,i.jsx)(s.h3,{id:"messages-std_msgs-geometry_msgs",children:"Messages: std_msgs, geometry_msgs"}),"\n",(0,i.jsx)(s.p,{children:"Messages are data structures used for communication over topics. ROS 2 provides a rich set of standard message types, organized into packages:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.code,{children:"std_msgs"})}),": Contains basic data types like ",(0,i.jsx)(s.code,{children:"String"}),", ",(0,i.jsx)(s.code,{children:"Int32"}),", ",(0,i.jsx)(s.code,{children:"Float64"}),", ",(0,i.jsx)(s.code,{children:"Bool"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.code,{children:"geometry_msgs"})}),": Defines common geometric primitives like ",(0,i.jsx)(s.code,{children:"Point"}),", ",(0,i.jsx)(s.code,{children:"Pose"}),", ",(0,i.jsx)(s.code,{children:"Twist"})," (linear and angular velocity)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.code,{children:"sensor_msgs"})}),": For sensor data like ",(0,i.jsx)(s.code,{children:"Image"}),", ",(0,i.jsx)(s.code,{children:"PointCloud2"}),", ",(0,i.jsx)(s.code,{children:"Imu"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"You can also define custom message types for application-specific data."}),"\n",(0,i.jsx)(s.h3,{id:"example-simple-publisher-and-subscriber",children:"Example: Simple Publisher and Subscriber"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.code,{children:"my_python_package/my_python_package/simple_publisher.py"})})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass SimplePublisher(Node):\r\n    def __init__(self):\r\n        super().__init__('simple_publisher')\r\n        self.publisher_ = self.create_publisher(String, 'my_topic', 10)\r\n        timer_period = 0.5  # seconds\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = 'Hello ROS 2! %d' % self.i\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\r\n        self.i += 1\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    simple_publisher = SimplePublisher()\r\n    rclpy.spin(simple_publisher)\r\n    simple_publisher.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.code,{children:"my_python_package/my_python_package/simple_subscriber.py"})})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass SimpleSubscriber(Node):\r\n    def __init__(self):\r\n        super().__init__('simple_subscriber')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'my_topic',\r\n            self.listener_callback,\r\n            10)\r\n        self.subscription  # prevent unused variable warning\r\n\r\n    def listener_callback(self, msg):\r\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    simple_subscriber = SimpleSubscriber()\r\n    rclpy.spin(simple_subscriber)\r\n    simple_subscriber.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(s.h2,{id:"services-requestresponse",children:"Services: Request/Response"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Services"})," are a communication mechanism in ROS 2 that implements a request/response pattern. They are used for synchronous, blocking calls where a client sends a request and waits for a server to send back a response."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-mermaid",children:"graph LR\r\n    C[Client Node] -- Request --\x3e S(Service)\r\n    S -- Response --\x3e C\r\n    S -- Service Handler --\x3e SR[Service Server Node]\n"})}),"\n",(0,i.jsx)(s.h3,{id:"example-simple-service-server-and-client",children:"Example: Simple Service Server and Client"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.code,{children:"my_python_package/my_python_package/simple_service_server.py"})})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.srv import AddTwoInts # Standard service type\r\n\r\nclass SimpleServiceServer(Node):\r\n    def __init__(self):\r\n        super().__init__('simple_service_server')\r\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\r\n        self.get_logger().info('Service server ready.')\r\n\r\n    def add_two_ints_callback(self, request, response):\r\n        response.sum = request.a + request.b\r\n        self.get_logger().info(f'Incoming request: a={request.a}, b={request.b}. Sum: {response.sum}')\r\n        return response\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    simple_service_server = SimpleServiceServer()\r\n    rclpy.spin(simple_service_server)\r\n    simple_service_server.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.code,{children:"my_python_package/my_python_package/simple_service_client.py"})})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import sys\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.srv import AddTwoInts\r\n\r\nclass SimpleServiceClient(Node):\r\n    def __init__(self):\r\n        super().__init__('simple_service_client')\r\n        self.client = self.create_client(AddTwoInts, 'add_two_ints')\r\n        while not self.client.wait_for_service(timeout_sec=1.0):\r\n            self.get_logger().info('service not available, waiting again...')\r\n        self.req = AddTwoInts.Request()\r\n\r\n    def send_request(self, a, b):\r\n        self.req.a = a\r\n        self.req.b = b\r\n        self.future = self.client.call_async(self.req)\r\n        rclpy.spin_until_future_complete(self, self.future)\r\n        return self.future.result()\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    simple_service_client = SimpleServiceClient()\r\n    \r\n    if len(sys.argv) != 3:\r\n        simple_service_client.get_logger().info('Usage: ros2 run my_python_package simple_service_client A B')\r\n        simple_service_client.destroy_node()\r\n        rclpy.shutdown()\r\n        sys.exit(1)\r\n\r\n    a = int(sys.argv[1])\r\n    b = int(sys.argv[2])\r\n    response = simple_service_client.send_request(a, b)\r\n    simple_service_client.get_logger().info(f'Result of add_two_ints: for {a} + {b} = {response.sum}')\r\n    \r\n    simple_service_client.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(s.h2,{id:"actions-long-running-tasks",children:"Actions: Long-running tasks"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Actions"})," are a high-level communication type for long-running, goal-oriented tasks. They combine aspects of topics (for feedback) and services (for a goal and result).\r\nAn action client sends a goal, receives continuous feedback, and eventually gets a result. An action server processes the goal, publishes feedback, and sends a final result."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-mermaid",children:"graph LR\r\n    AC[Action Client] -- Goal --\x3e AS(Action Server)\r\n    AS -- Feedback --\x3e AC\r\n    AS -- Result --\x3e AC\n"})}),"\n",(0,i.jsx)(s.h2,{id:"qos-settings",children:"QoS Settings"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Quality of Service (QoS)"})," policies in ROS 2 allow you to configure the behavior of communication between nodes. This is crucial for matching the communication needs of different parts of a robotic system (e.g., high-frequency sensor data vs. critical command messages)."]}),"\n",(0,i.jsx)(s.p,{children:"Common QoS policies include:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"History"}),": How many messages to keep."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Depth"}),": How many messages to keep for ",(0,i.jsx)(s.code,{children:"KEEP_LAST"})," history."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Reliability"}),": ",(0,i.jsx)(s.code,{children:"Reliable"})," (guaranteed delivery) vs. ",(0,i.jsx)(s.code,{children:"Best Effort"})," (faster, no guarantees)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Durability"}),": ",(0,i.jsx)(s.code,{children:"Transient Local"})," (new subscribers get last published message) vs. ",(0,i.jsx)(s.code,{children:"Volatile"})," (only messages published while subscriber is active)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Liveliness"}),": How long the system should consider a publisher alive."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"These settings are configured when creating publishers, subscribers, service clients/servers, and action clients/servers."})]})}function p(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>l});var r=n(6540);const i={},o=r.createContext(i);function t(e){const s=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(o.Provider,{value:s},e.children)}}}]);