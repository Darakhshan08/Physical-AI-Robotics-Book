"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[8447],{4376:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"module-1-ros2/python-packages","title":"Building ROS 2 Packages with Python (rclpy)","description":"Python package structure, setup.py and package.xml, Entry points and console scripts, Dependencies management, Building and running.","source":"@site/docs/module-1-ros2/python-packages.mdx","sourceDirName":"module-1-ros2","slug":"/module-1-ros2/python-packages","permalink":"/Physical-AI-Humanoid-Robotics-Textbook/docs/module-1-ros2/python-packages","draft":false,"unlisted":false,"editUrl":"https://github.com/Darakhshan08/Physical-AI-Humanoid-Robotics-Textbook/tree/main/docs/module-1-ros2/python-packages.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"id":"python-packages","title":"Building ROS 2 Packages with Python (rclpy)","sidebar_label":"Python Packages","sidebar_position":3,"description":"Python package structure, setup.py and package.xml, Entry points and console scripts, Dependencies management, Building and running.","keywords":["ros2","python","rclpy","package","setup.py","package.xml","colcon"]},"sidebar":"tutorialSidebar","previous":{"title":"Nodes, Topics, Services","permalink":"/Physical-AI-Humanoid-Robotics-Textbook/docs/module-1-ros2/nodes-topics-services"},"next":{"title":"URDF for Humanoids","permalink":"/Physical-AI-Humanoid-Robotics-Textbook/docs/module-1-ros2/urdf-humanoids"}}');var r=s(4848),i=s(8453);const o={id:"python-packages",title:"Building ROS 2 Packages with Python (rclpy)",sidebar_label:"Python Packages",sidebar_position:3,description:"Python package structure, setup.py and package.xml, Entry points and console scripts, Dependencies management, Building and running.",keywords:["ros2","python","rclpy","package","setup.py","package.xml","colcon"]},c="Building ROS 2 Packages with Python (rclpy)",t={},l=[{value:"Python Package Structure",id:"python-package-structure",level:2},{value:"setup.py and package.xml",id:"setuppy-and-packagexml",level:2},{value:"Entry Points and Console Scripts",id:"entry-points-and-console-scripts",level:2},{value:"Dependencies Management",id:"dependencies-management",level:2},{value:"Building and Running",id:"building-and-running",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"building-ros-2-packages-with-python-rclpy",children:"Building ROS 2 Packages with Python (rclpy)"})}),"\n",(0,r.jsxs)(n.p,{children:["Developing in ROS 2 with Python is highly encouraged due to Python's ease of use and extensive ecosystem of AI/ML libraries. This chapter guides you through creating and managing ROS 2 Python packages using ",(0,r.jsx)(n.code,{children:"rclpy"}),", the Python client library for ROS 2."]}),"\n",(0,r.jsx)(n.h2,{id:"python-package-structure",children:"Python Package Structure"}),"\n",(0,r.jsx)(n.p,{children:"A typical ROS 2 Python package structure looks like this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"my_python_package/\r\n\u251c\u2500\u2500 my_python_package/            # Python module directory (same name as package)\r\n\u2502   \u251c\u2500\u2500 __init__.py               # Makes 'my_python_package' a Python package\r\n\u2502   \u251c\u2500\u2500 my_node.py                # Your Python ROS 2 node(s)\r\n\u2502   \u2514\u2500\u2500 another_utility.py        # Other Python modules/utilities\r\n\u251c\u2500\u2500 resource/                     # Resource files (e.g., icons, images)\r\n\u251c\u2500\u2500 test/                         # Unit tests\r\n\u251c\u2500\u2500 package.xml                   # Package metadata\r\n\u251c\u2500\u2500 setup.py                      # Python build configuration\r\n\u251c\u2500\u2500 setup.cfg                     # Python metadata for tools like `colcon`\r\n\u2514\u2500\u2500 CMakeLists.txt                # Required for colcon, even for pure Python packages\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The core components for a Python package are ",(0,r.jsx)(n.code,{children:"package.xml"})," and ",(0,r.jsx)(n.code,{children:"setup.py"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"setuppy-and-packagexml",children:"setup.py and package.xml"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"package.xml"})}),": This file contains essential metadata about your ROS 2 package, such as its name, version, description, maintainers, license, and dependencies. It's an XML file and is crucial for ROS 2 tools like ",(0,r.jsx)(n.code,{children:"colcon"})," and ",(0,r.jsx)(n.code,{children:"rosdep"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\r\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\r\n<package format="3">\r\n  <name>my_python_package</name>\r\n  <version>0.0.0</version>\r\n  <description>A simple ROS 2 Python package.</description>\r\n  <maintainer email="user@example.com">Your Name</maintainer>\r\n  <license>Apache-2.0</license>\r\n\r\n  <depend>rclpy</depend>\r\n  <depend>std_msgs</depend>\r\n  \x3c!-- Add other message/service dependencies here --\x3e\r\n\r\n  <test_depend>ament_copyright</test_depend>\r\n  <test_depend>ament_flake8</test_depend>\r\n  <test_depend>ament_pep257</test_depend>\r\n  <test_depend>python3-pytest</test_depend>\r\n\r\n  <export>\r\n    <build_type>ament_python</build_type>\r\n  </export>\r\n</package>\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"setup.py"})}),": This Python script defines how your package is built and what executables (nodes, console scripts) it provides. It's used by ",(0,r.jsx)(n.code,{children:"setuptools"}),", which ",(0,r.jsx)(n.code,{children:"colcon"})," orchestrates."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from setuptools import find_packages, setup\r\nimport os\r\nfrom glob import glob\r\n\r\npackage_name = 'my_python_package'\r\n\r\nsetup(\r\n    name=package_name,\r\n    version='0.0.0',\r\n    packages=find_packages(exclude=['test']),\r\n    data_files=[\r\n        ('share/ament_index/resource_index/packages',\r\n            ['resource/' + package_name]),\r\n        ('share/' + package_name, ['package.xml']),\r\n        (os.path.join('share', package_name, 'launch'), glob(os.path.join('launch', '*launch.[pxy][yeml]'))),\r\n        # Add other data files like config, rviz etc.\r\n    ],\r\n    install_requires=['setuptools'],\r\n    zip_safe=True,\r\n    maintainer='Your Name',\r\n    maintainer_email='user@example.com',\r\n    description='A simple ROS 2 Python package.',\r\n    license='Apache-2.0',\r\n    tests_require=['pytest'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'simple_publisher = my_python_package.simple_publisher:main',\r\n            'simple_subscriber = my_python_package.simple_subscriber:main',\r\n            'simple_service_server = my_python_package.simple_service_server:main',\r\n            'simple_service_client = my_python_package.simple_service_client:main',\r\n            # Add other nodes here\r\n        ],\r\n    },\r\n)\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"entry-points-and-console-scripts",children:"Entry Points and Console Scripts"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"entry_points"})," dictionary in ",(0,r.jsx)(n.code,{children:"setup.py"})," is where you define your executables."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"'console_scripts'"})," specifies command-line tools that ",(0,r.jsx)(n.code,{children:"colcon"})," will make available."]}),"\n",(0,r.jsxs)(n.li,{children:["The format is ",(0,r.jsx)(n.code,{children:"executable_name = python_module.python_file:main_function"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For example, ",(0,r.jsx)(n.code,{children:"simple_publisher = my_python_package.simple_publisher:main"})," means that when you run ",(0,r.jsx)(n.code,{children:"ros2 run my_python_package simple_publisher"}),", ",(0,r.jsx)(n.code,{children:"colcon"})," will execute the ",(0,r.jsx)(n.code,{children:"main()"})," function within the ",(0,r.jsx)(n.code,{children:"simple_publisher.py"})," file found inside the ",(0,r.jsx)(n.code,{children:"my_python_package"})," Python module."]}),"\n",(0,r.jsx)(n.h2,{id:"dependencies-management",children:"Dependencies Management"}),"\n",(0,r.jsxs)(n.p,{children:["Dependencies are declared in ",(0,r.jsx)(n.code,{children:"package.xml"})," and ",(0,r.jsx)(n.code,{children:"setup.py"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"package.xml"})," (",(0,r.jsx)(n.code,{children:"<depend>"}),")"]}),": For ROS 2 packages and message types (e.g., ",(0,r.jsx)(n.code,{children:"rclpy"}),", ",(0,r.jsx)(n.code,{children:"std_msgs"}),"). Used by ",(0,r.jsx)(n.code,{children:"rosdep"})," to install system dependencies."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"setup.py"})," (",(0,r.jsx)(n.code,{children:"install_requires"}),")"]}),": For standard Python packages (e.g., ",(0,r.jsx)(n.code,{children:"setuptools"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["It's crucial to keep these in sync. Use ",(0,r.jsx)(n.code,{children:"rosdep install --from-paths src --ignore-src -r -y"})," in your workspace root to install missing system dependencies."]}),"\n",(0,r.jsx)(n.h2,{id:"building-and-running",children:"Building and Running"}),"\n",(0,r.jsx)(n.p,{children:"To build your Python package:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\r\ncolcon build --packages-select my_python_package\n"})}),"\n",(0,r.jsx)(n.p,{children:"After building, you must source your workspace to make the new executables available:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"source install/setup.bash\n"})}),"\n",(0,r.jsx)(n.p,{children:"Now you can run your nodes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 run my_python_package simple_publisher\r\nros2 run my_python_package simple_subscriber <args>\n"})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var a=s(6540);const r={},i=a.createContext(r);function o(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);